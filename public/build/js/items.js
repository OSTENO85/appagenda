!function(){e();async function e(){try{const e=`/api/items?id=${o()}`,t=await fetch(e),a=await t.json(),{items:r}=a;!function(e){const t=document.querySelector("#listado-items");if(t.innerHTML="",0===e.length){const e=document.createElement("LI");return e.textContent="No hay Items",e.classList.add("no-items"),t.appendChild(e),void n(0)}let o=0;e.forEach((e=>{const n=document.createElement("LI");n.dataset.itemId=e.id,n.classList.add("item");const a=document.createElement("P");a.textContent=e.nombre;const r=document.createElement("P");r.textContent=e.monto,o+=parseFloat(e.monto)||0,n.appendChild(a),n.appendChild(r),t.appendChild(n)}));const a=document.createElement("DIV");a.classList.add("total-items"),a.textContent=`Total: ${o.toFixed(2)}`,t.appendChild(a),n(o)}(r)}catch(e){console.log(e)}}function t(e,t,o){const n=document.querySelector(".alerta");n&&n.remove();const a=document.createElement("DIV");a.classList.add("alerta",t),a.textContent=e,o.parentElement.insertBefore(a,o),setTimeout((()=>{a.remove()}),5e3)}function o(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}async function n(e){try{const t=o(),n=new FormData;n.append("id",t),n.append("total",e.toFixed(2));const a="/api/facturas/actualizar-total",r=await fetch(a,{method:"POST",body:n}),c=await r.json();console.log("Total actualizado:",c)}catch(e){console.error("Error actualizando el total:",e)}}document.querySelector("#agregar-item").addEventListener("click",(function(){const n=document.createElement("DIV");n.classList.add("modal"),n.innerHTML='\n\n       <form class="formulario nuevo-item" method="POST" action="">\n    <legend>Añade un nuevo item</legend>\n\n    <div class="campo">\n        <label for="nombre">nombre</label>\n        <input type="text" name="nombre" id="nombre" placeholder="Nombre item" required>\n    </div>\n\n    <div class="campo">\n        <label for="monto">Monto</label>\n        <input type="number" name="monto" id="monto" placeholder="Ej: 1000" step="0.01" required>\n    </div>\n\n    <div class="opciones">\n        <input type="submit" class="submit-nuevo-item" value="Añadir Item">\n        <button type="button" class="cerrar-modal">Cerrar</button>\n    </div>\n</form>\n\n        ',setTimeout((()=>{document.querySelector(".formulario").classList.add("animar")}),0),n.addEventListener("click",(function(a){if(a.preventDefault(),a.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout((()=>{n.remove()}),100)}a.target.classList.contains("submit-nuevo-item")&&function(){const n=document.querySelector("#nombre").value.trim(),a=document.querySelector("#monto").value.trim();if(""===n)return void t("El nombre es obligatorio","error",document.querySelector(".formulario legend"));if(""===a)return void t("El monto es obligatorio","error",document.querySelector(".formulario legend"));!async function(n,a){const r=new FormData;r.append("nombre",n),r.append("monto",a),r.append("facturaId",o());try{const o="http://localhost:3000/api/items",n=await fetch(o,{method:"POST",body:r}),a=await n.json();if(t(a.mensaje,a.tipo,document.querySelector(".formulario legend")),"exito"==a.tipo){e();const t=document.querySelector(".modal");setTimeout((()=>{t.remove()}),300)}}catch(e){console.log(e)}}(n,a)}()})),document.querySelector("body").appendChild(n)}))}();